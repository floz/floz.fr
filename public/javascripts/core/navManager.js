// Generated by CoffeeScript 1.5.0-pre
var navManager,
  __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

navManager = (function() {
  var NavManager, _instance;

  function navManager() {}

  NavManager = (function() {

    NavManager.prototype._$mainContent = null;

    function NavManager() {
      this._onLoadSuccess = __bind(this._onLoadSuccess, this);
      this._onPopState = __bind(this._onPopState, this);      this._$mainContent = $("#main_content");
      $(window).bind("popstate", this._onPopState);
    }

    NavManager.prototype._onPopState = function(e) {
      if (!window.history.state) {
        window.history.replaceState({
          path: "/ajax"
        }, "", "/");
      }
      return this._load();
    };

    NavManager.prototype.set = function(url, urlAjax) {
      window.history.pushState({
        path: urlAjax
      }, "", url);
      return this._load();
    };

    NavManager.prototype._load = function() {
      var path;
      path = window.history.state.path;
      return $.ajax({
        url: path,
        success: this._onLoadSuccess
      });
    };

    NavManager.prototype._onLoadSuccess = function(data) {
      console.log(window.history.state);
      return this._$mainContent.html(data);
    };

    return NavManager;

  })();

  _instance = null;

  navManager.get = function() {
    return _instance != null ? _instance : _instance = new NavManager();
  };

  return navManager;

}).call(this);
